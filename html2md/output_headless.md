[![]()](javascript:void\(0\))

![](https://pic1.zhimg.com/v2-45bd10426541b3d82bace746e8b5a53a.png)

知乎

有问题就会有答案

打开App

![理解人类语言：电脑AI写作原理，神经网络语言模型的运作
\(1\)](https://picx.zhimg.com/v2-d8d329dd71050cadba306768c16eb138_720w.jpg?source=172ae18b)

# 理解人类语言：电脑AI写作原理，神经网络语言模型的运作 (1)

2 年前 · 来自专栏 技术备忘录

[![PENG
Bo](https://pica.zhimg.com/v2-c0e93926aa1716772a26677284a6bbec_l.jpg?source=172ae18b)](//www.zhihu.com/people/bopengbopeng)

[PENG
Bo](//www.zhihu.com/people/bopengbopeng)[​](https://www.zhihu.com/question/48509984)

人工智能话题下的优秀答主

​关注

在本系列中，我将尽可能通俗易懂地，深入讲述电脑 AI 的写作原理（包括细节）。

人类写作，有想法，有写作目标，可能还有提纲，有整体结构的构思。然后，用语法和修辞表述出来。

电脑写作，最常见的方法是，一个个字写。每次分析一遍前文，然后在后面添一个字。

## 一、电脑的写作过程

在电脑眼中，写作是个数学问题。

举例，输入“这是一只”，然后让电脑续写，它的写作过程如下：

![](https://pic4.zhimg.com/v2-0f6784e252911315b0b84e0693ba5bf7_b.jpg)

![](https://pic4.zhimg.com/80/v2-0f6784e252911315b0b84e0693ba5bf7_720w.webp)

电脑的思维模型，是一个神奇函数 F(C)，输入前文 C，输出下一个字的概率分布。

电脑的写作过程：

  1. 电脑计算 F(这是一只) = 3%巨，2%体，2%黑，1%有，1%大，… 电脑按照概率分布，决定下一个字选择“来”。
  2. 电脑计算 F(这是一只来) = 89%自，4% 历，… 电脑按照概率分布，决定下一个字选择“自”。
  3. 电脑计算 F(这是一只来自) = 16%于，5% 地，… 电脑按照概率分布，决定下一个字选择“大”。

注意：“按照概率分布决定”的意思是，按照这个分布随机选择。例如，“这是一只”后面，有3%的概率选“巨”，2%的概率选“体”（而不是每次直接选概率最高的字，因为那样出来的内容很容易重复）。所以，同样的开头，电脑每次续写的结果都会千变万化。

于是，电脑可以一个个字写下去，写出任意长的内容。

如果你仔细看，会发现这个电脑有时计算的概率不准（例如“这是一只来自大海的海洋”后面逗号和句号的概率过高），因为它是个小模型，它对于中文的理解还不够准确。

我训练的 AI 写作模型是开源的，可以在这里下载（需要电脑）：

[](https://link.zhihu.com/?target=https%3A//github.com/BlinkDL/AI-Writer)

还有一个网页版，在手机点开就能写（不过比电脑版弱一些）：

[](https://link.zhihu.com/?target=https%3A//blinkdl.github.io/AI-Writer/)

* * *

那么，电脑是如何计算出这个神奇函数 F(C)？

首先，将所有字符（汉字、标点、数字、外语、符号等等）都编码成数字。

我的模型有一个固定的字符表，支持 8849 种字符（可以支持更多，但越大运行越慢，所以八千多够用了）：

![](https://pic4.zhimg.com/v2-0e003415f351d8a941eba537e1bfdf9b_b.jpg)

![](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg'
width='678' height='64'></svg>)

所以“这是一只”会变成【7587, 3482, 605, 1372】。

然后 F(7587, 3482, 605, 1372) 会计算出 8849 个概率，对应下一个字的概率分布。

例如“巨”在字表是 2565，F(7587, 3482, 605, 1372) 输出的第 2565 个概率是
0.0375。所以“这是一只”下一个字是“巨”的概率是 3.75%。

例如“体”在字表是 824，F(7587, 3482, 605, 1372) 输出的第 824 个概率是 0.0234。所以

展开阅读全文​

编辑于 2022-05-03 15:30

在哪个瞬间你真正意识到真的失去了一个人？

![](https://pic3.zhimg.com/4decd6a9aceae904b438aabb031f282b.jpg)

Seasee Y...

![](https://pic1.zhimg.com/50/v2-5b7012c8c22fd520f5677305e1e551bf.webp)

半年前，我收到一张陌生人发来的彩信，照片上我妻子衣着暴露，我从没见过那样的妻子，她眼神暧昧，躺在一个陌生的房间。这张照片让我大脑一阵眩晕，我点燃一支烟，发现自己的身体在发抖，我给那个陌生人回复短信：「你是谁，想干什么？」半分钟后，他回过来一条极度羞辱的文字：「你老婆挺有味道，跟着你可惜了。」我怒不可遏地拨过去电话，那人却关了机。整个下午，我觉得自己的大脑像一台失了控的机器，一会儿想到这里，一会儿想到哪里，直到办公室的人都走光了我还傻愣着坐在椅子上。我跑到厕所再次打开手机，把照片放到最大，幻想着这张照片是
P
的，看了一分钟绝望地意识到，这张照片是真的，阮颜的腰边有颗痣，这种隐秘的特征只有很亲近的人才知道。照片上的阮颜，痣的位置一模一样。我和阮颜相识六年，结婚四年，在过往的记忆里，阮颜一直是个干净温柔的女人，她的相貌出众，大眼睛高鼻梁，精致的五官却没有攻击性，读大学的时候就是校花级别的美女。跟我谈恋爱后也没做过什么出格的事情，当时我们异地恋一年，我在广州跑销售，她在武汉卖房子，每天晚上都要打一通电话。在我的认知里，阮颜是个放不开的女孩，还记得我们第一次上床时，阮颜害羞地钻进被窝，等我爬上床时，她突然严肃的对我说了一句话：「陈树，我先把话跟你说清楚，我不是处女，如果你介意这个，那就别碰我，咱俩可以随时结束。如果你不介意这个碰了我，那以后就别提这个事，不然我会翻脸的。」当时我以一个非常尴尬的姿势楞在原地，裤子脱到一般，毛衣甩在地上，我知道她在我之前谈过两个男朋友，现在这个时代，用我朋友老枪的话来说，想找处女只能去幼儿园了，我把这些事看得很开。但是她这么直白的提出来，我还是有点膈应，我说：「我不在乎你之前的事儿，但你也要保证，跟了我以后就别跟其它男人乱七八糟。」阮颜听到这话眉头一松，把自己的内衣内裤都脱了，像只小猫钻进我怀里。那天夜里我们确定了关系，黑暗里，阮颜紧紧地咬住嘴唇一声不吭，很难判断她是享受还是难受，事后我问她：「感觉怎么样？」阮颜红着脸拍了一下我肩膀：「你怎么这么流氓，烦人。」说实话，见到她娇羞的模样我心里很开心，这说明她的性经历并不丰富，或者说，她本质上不是个放荡的女人。但是现在……我顶着寒风走出办公大楼，钻进自己的车内，给阮颜打过去一个电话，电话那头有点吵，我问她在干什么，她说：「快下班了，今天看房的人特别多，你先回去把饭做了，等我回来就做菜。」我笑着说：「不用，今天我们出去吃，我现在来接你。」阮颜有点惊讶：「出去吃？你发奖金了？」我说：「对，发了一万多，咱们今天吃顿好的。」挂完电话后，我的眼泪不争气的流出来，臭婊子，我在心里骂。2如果把城市比做人，北京就是一身贵气的公子哥，上海则是西装革履的成功人士，成都就像一个打扮清纯的少女，那武汉呢？武汉应该是一个叼着烟光着赤膊的小痞子，一身匪气直来直去，但没什么坏心思。我和阮颜要结婚的时候，她爸给我提了三个要求：一，不管遇到什么事，不能动手打人。二，可以赚不到什么钱，但是不能躺在家里不赚钱。三，每个月至少回去看一次他们，什么东西都不用买，他们还管饭。我当时很感动，九十年代计划生育，阮颜父母就她一个宝贝女儿，把她看得比性命还重，在家里连个地都不让她扫，我举起杯子对未来岳父说：「爸，你放心，我就是把命拼了，也会带阮颜过好日子。」说完一口把杯里的白酒喝完，喝到中途阮颜拉拉我胳膊，怕我喝多了，阮颜父亲却说：「让他喝完。」阮颜出嫁那天，老两口都情绪低落，阮颜的妈妈眼睛肿的很高，估计是哭了几趟，她爸递给我一个红包，哑着嗓子说：「陈树，阮颜就交给你了，记住你说过的话。」我朝二老鞠了一躬，把阮颜抱出她家的门。那个红包里有两张卡，里面有三十五万，几乎是老两口的全部积蓄，他爸说结婚了还在外面租房不像个话，拿这钱付个首付。我不是一个不识好歹的人，打从结婚那天起，我就想方设法赚钱，全国各地跑经销商，从一个小职员跑到副经理的岗位，一年瘦了二十斤，和老板喝酒喝得胃穿孔，只为了两万块钱的提成。他爸给的那笔钱我一分都没动，两年后在三环买了个一百二十平的大三居，又过了一年买了辆奥迪
A4，不仅如此，我赚的所有钱全部放在阮颜那里，身上只留几千块钱零花急用，算下来也应该有了百八十万，平时她看上什么衣服首饰，我二话不说直接刷卡，从来不看标签。我自认为已回报了她的「下嫁」，她为什么还要做这种事？「你在想什么呢，跟丢了魂似的？」阮颜用筷子敲敲我的手，边喝水边问。「没……没什么，你这件衣服什么时候买的？」我突然发现她穿着我没见过的黑色裙子，束带把腰系的紧紧的，很显身材。不仅如此，她还化着精妆，我记得以前她都是洗把脸涂个口红就出门上班，现在又是打粉又是描眉，宁愿早起半个小时，也要把脸收拾的漂漂亮亮。很有可能，「奸夫」就是她们公司的，我在心里恨恨地想。「前几天买的，对了，你又发什么奖金？」她吃了口菜，想把话题岔开。「和谁一起买的？」「杜琳啊，还能有谁。」「哪天买的？」「你干嘛啊？」阮颜察觉到我的穷追不舍，皱着眉头站起来：「警察审犯人呢，你到底想问什么？」我连忙笑笑，说这件衣服太适合她了，把她衬的像明星，应该多买几件换着穿。阮颜转怒为笑，用指甲掐了我一下：「结账去，神经兮兮的。」3回到家已经快十点，我们轮流洗完澡，阮颜躺在床上玩手机，想到那张照片，我突然心血来潮，把她压住脱她的睡衣，她用手抵住我：「太晚了，我好累，明天还要早起呢。」「没事儿，明天我送你。」「我不要，等几天吧。」我懒得搭理她，脱掉她的上衣又开始扯她裤子，不知道是不是我的动作太粗暴，她用力的踢了我一脚：「你烦不烦，说了我不想。」我牙齿咬的咯咯作响，但是没有发作，穿好衣服走到窗边抽烟。估计是觉得自己做的太过分，阮颜揉了揉大腿，带着撒娇的口吻说：「你弄疼我了。」毫无疑问，这女人的心思已经不在我身上。我拿上烟灰缸去客厅，开始筹划我并不情愿的计划，在社会上混了这么久，我懂得一个道理，无论是遭遇到幸福还是不幸，都要先学会忍耐，谋定而后动，才能做出最有利于自己的举动。首要的事情，就是找出她出轨的更多证据，还要找到那个奸夫。最好抓奸在床，这样她就无话可说。然后，想个办法把放在她手上的钱弄回来，这些都是我的血汗钱，不能便宜她和那个奸夫。最后，再好好的出这口恶气，一定要想个解气的法子。把这张照片发到网上，让她成「网红」？不大好，这样我也跟着丢脸，谁都知道我戴了绿帽子。找个有性病的小姐，让她去勾引那个男人，让他们都得病？可以考虑，但实施起来很麻烦。我就像一条吐着信子的毒蛇，在黑暗的空间里，内心的恶毒在张牙舞爪。4星期五的上午我找了个私家侦探，说穿了就是个盯梢的，给了他八千块钱，让他跟踪阮颜汇报行程，同时我查了查阮颜的电话和信息记录，发现她和两个男人联系密切，一个就是她的初恋情人张诚，那小子就是个小白脸，长得一表人才，其实就是个绣花枕头。我听说在他们谈恋爱的时候，有一晚在外面吃饭，阮颜被几个小流氓调戏，又是吹口哨又是动手动脚，张诚低着脑袋一言不发，还是饭店老板过来解围，阮颜出门后质问张诚：「你为什么不帮我出头？」张诚唯唯诺诺地说：「他们……他们有四个人呢，好汉不吃眼前亏。」阮颜还骗我说什么她和张诚早就没有联系了，这段时间他们打过好几通电话，有一次还是在深夜两点，妈的，那个点能聊什么呢？另一个人叫做「苏经理」，阮颜和他联系的频率更高，几乎每天中午都要打二三十分钟电话，如果我猜的没错，那个人应该就是她们公司的一个小头头。现在这个社会，手上有点权力搞女下属，也不算什么稀奇事，我只是觉得难过，阮颜不应该是这么下贱的人。我把杜琳约出来喝茶，杜琳和阮颜是好多年的朋友，大学在一个宿舍，毕业了又在一个公司，我和阮颜结婚的时候杜琳还是伴娘，如果阮颜有什么反常的地方，杜琳应该能感觉得到。杜琳穿着墨绿色裙子，扎着干练的马尾，白皙的额头下有一双灵动的眼睛，在昏暗的光线下显得很有女人味。「难得啊，陈总今天怎么想起请我吃饭？是不是在外面偷腥被阮颜抓住，要我帮着求情呀？」杜琳跟我开玩笑。「对，你可得帮我说说好话，不然我就要被她扫地出门了。」我笑眯眯地给她倒茶。「说得跟真的似的，说吧，什么事？」杜琳白了我一眼，抿一口茶。「你们公司是不是有个姓苏的经理？」「你怎么知道的？他上个月才从总公司调过来，现在我和阮颜都归他管。」杜琳有点惊讶。「空降的领导？是不是很有钱啊？」「应该挺有钱的，而且他年纪不大，在深圳都有好几套房子，听说是个富二代。」富二代？我想起那张照片和那些挑衅的文字，像是富二代做出来的事情。「你知道张诚吧？」我试探性的问。「哪个张诚？」「阮颜的初恋男友，你没见过？」杜琳想了半晌，噗嗤一声笑出来，拍着桌子讽刺我：「哈哈哈，那都是猴年马月的事儿了，你还耿耿于怀呢，不是我批评你，陈总，男人要大度……」看来杜琳也不知道阮颜和张诚还有联系，我的脸上不动声色，点了一大桌子菜，有一搭没一搭和她开玩笑，出门的时候杜琳脚一滑差点摔倒，我连忙把她搀住，她整个人都贴在我怀里，我闻到她身上的香味，她有点不好意思，连忙站直松开我胳膊，她脸上红彤彤的，故作开朗地说道：「呀，不小心吃你豆腐了。」看着杜琳稍带羞涩的模样，我突然涌起一阵悸动，脑中浮现出一个完美的报复计划。5「这段时间你怎么老和老枪他们打牌，你看现在都几点了？」凌晨两点半阮颜还坐在沙发上，把刚进屋的我吓一跳。「应酬嘛，老枪认识很多老板，也可以拉业务。」我把外套甩在沙发上，去卫生间洗了一把脸。「陈树。」阮颜追到卫生间，表情有点凝重：「家里卡上的钱都去哪了？」这女人比我想象中还要迟钝，我都把钱弄走一个礼拜了，她现在才发觉。「哦，我忘了跟你说了，我认识一个开发软件的老板，把钱全投到他项目里了。」「你怎么不和我商量一下？」阮颜分贝加大：「这么多钱，你全砸进去了，万一亏了怎么办？你有没有把我当你老婆？」靠，真他妈该给你颁个影后奖，我在心里暗骂。「不会亏的，放心好了，那项目回报率特别高，说不定到年底咱就成千万富翁啦。」我笑着冲她说。女人总是很相信男人画的大饼，我信口开河，把那个不存在的项目吹的天花乱坠，阮颜明显放下了顾虑，拿起手机进房睡觉。我们已经大半个月没过夫妻生活了，这也好，她的心思不在我这，我也不愿意碰她。第二天一早，阮颜要我陪她回娘家，我找了个托辞说手上有事，让她自己过去。等她下楼后，我打通老枪的电话，那边闹哄哄的，老枪冲我嚷嚷：「人已经逮到了，你直接过来，就在大海的货仓。」我终于见到张诚的真人，他被揍得鼻青脸肿，鼻血全流到体恤上，身体发抖嘴唇打颤，就像随时要尿裤子的模样，我让老枪把那群小混混都支走，拍拍张诚的脸：「你认识我吗？」张诚看了我一眼，摇摇头。我点燃一根烟，放到他嘴里，对他说：「我问你什么，你就答什么，老老实实的什么事都不会有，要是你想玩花样，他们可以陪你多玩玩。」张诚目光呆滞，好像没听懂我的意思，老枪提起手就是两耳光，张诚立马哭爹喊娘的惨叫起来，老枪指着他说：「你他妈再叫，舌头跟你剁了信不？」张诚连忙闭嘴，浑黄的眼泪顺着眼角淌下来，那模样别提多恶心了。「你，认不认识我？」我又问了一遍。「认识认识，你是阮颜的老公。」张诚捣蒜一样点头。「好极了。」我拿出手机，把那张照片放到他眼前：「这张照片是不是你发的？」「不是。」张诚疯狂摇头。「你他妈看清楚一点。」这小子好像被吓破了胆，看了不到一秒就开始摇头。「真的不是，大哥，我和阮颜几年没见了……」张诚带着哭腔求饶。「那你和她打电话都说了什么？」我直直地看着他，真不清楚阮颜为什么会喜欢这种小白脸。「前段时间我妈生病了，我找她借了一万块钱，后来我赚到钱还给她，说请她还有大哥你吃顿饭，她说不用了，要我不要再联系她，我们……一直没见面。」老枪拿起旁边柜子上的一把扳手，装模作样挥了两下，对我说：「我看这小子还是没说实话，要不再陪他玩玩吧。」

4647 点赞 · 219 评论 · 盐选推荐

### 文章被以下专栏收录

![技术备忘录](https://picx.zhimg.com/v2-e4867a2e7a0afdac40fdb97191a54ed6_l.jpg?source=172ae18b)

## 技术备忘录

现代数学、人工智能、物理等等。

### 推荐阅读

[人语机器人语机器 原创作者：法狗狗 NLP 数据科学家 - 邦德 有人说2017年是…Nong... · 发表于法狗狗的技术窝![人语机器](https://picx.zhimg.com/v2-7e042811d7ba7d6b37fdcea01e25776e_ipico.jpg?source=172ae18b)](https://zhuanlan.zhihu.com/p/35179645)[AI要达到真正人类水平的语言理解能力，应该模仿人脑 | DeepMind、斯坦福等重磅研究【新智元导读】DeepMind、斯坦福大学、谷歌等的研究团队近日发表论…新智元 · 发表于AI前沿研究![AI要达到真正人类水平的语言理解能力，应该模仿人脑 | DeepMind、斯坦福等重磅研究](https://picx.zhimg.com/v2-e3c6a659d2700ccf895ccc6f79224a72_ipico.jpg?source=172ae18b)](https://zhuanlan.zhihu.com/p/97878583)[Yann LeCun：语言的有限性决定了 AI 永远无法比肩人类智能寻找人工智能中的常识（common sense）是比关注语言更重要的任务。 整理 | 李梅、王玥 编辑 | 陈彩娴前段时间，谷歌工程师声称自家的 AI 聊天机器人 LaMDA 具有了意识，引发了一片混乱。 La…雷峰网](https://zhuanlan.zhihu.com/p/557663085)[人类大脑中真得存在语言区吗？早到不知道什么时候开始，我们好像默认了人类大脑中存在着语言区，…青格乐 · 发表于语言习得实验室![人类大脑中真得存在语言区吗？](https://picx.zhimg.com/v2-7dd54559da7d91f000d2728b8244f306_ipico.jpg?source=172ae18b)](https://zhuanlan.zhihu.com/p/24601355)

117

41

195

14

![](https://pica.zhimg.com/v2-c0e93926aa1716772a26677284a6bbec_l.jpg?source=172ae18b)![](https://pica.zhimg.com/v2-993390e1a2f4e53006a05b2502212ab3.png)

_想来知乎工作？请发送邮件到 jobs@zhihu.com_

